{% extends "base.html" %}

{% block title %}Promociones | Super Merengones{% endblock title %}

{% block content %}
<style>
	.promos-header {
		background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
		color: white;
		padding: 50px 20px;
		border-radius: 12px;
		margin-bottom: 40px;
		text-align: center;
	}

	.promos-header h1 {
		font-family: 'Playfair Display', serif;
		font-size: 2.5rem;
		margin-bottom: 10px;
	}

	.promos-header p {
		font-size: 1.1rem;
		opacity: 0.95;
	}

	.promos-grid {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
		gap: 30px;
		margin-bottom: 40px;
	}

	.promo-card {
		background: white;
		border-radius: 12px;
		overflow: hidden;
		box-shadow: 0 2px 8px rgba(0,0,0,0.08);
		transition: all 0.3s ease;
		display: flex;
		flex-direction: column;
		position: relative;
	}

	.promo-card:hover {
		transform: translateY(-10px);
		box-shadow: 0 12px 30px rgba(0,0,0,0.15);
	}

	.promo-image {
		width: 100%;
		height: 250px;
		background: linear-gradient(135deg, #f5e6eb 0%, #ffe6f0 100%);
		display: flex;
		align-items: center;
		justify-content: center;
		font-size: 4rem;
		position: relative;
		overflow: hidden;
	}

	.promo-image img {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}

	.promo-badge {
		position: absolute;
		top: 15px;
		right: 15px;
		background: var(--primary);
		color: white;
		padding: 10px 15px;
		border-radius: 8px;
		font-weight: 700;
		font-size: 1.2rem;
	}

	.promo-discount {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 60px;
		height: 60px;
		background: white;
		border-radius: 50%;
		position: absolute;
		top: 15px;
		right: 15px;
		box-shadow: 0 4px 12px rgba(0,0,0,0.15);
		color: var(--primary);
		font-weight: 700;
		font-size: 1.3rem;
	}

	.promo-content {
		padding: 25px;
		flex-grow: 1;
		display: flex;
		flex-direction: column;
	}

	.promo-title {
		font-size: 1.4rem;
		font-weight: 700;
		color: var(--dark);
		margin-bottom: 10px;
		min-height: 2.8rem;
	}

	.promo-description {
		color: var(--text);
		font-size: 0.95rem;
		line-height: 1.5;
		margin-bottom: 15px;
		flex-grow: 1;
	}

	.promo-dates {
		background: var(--light);
		padding: 12px;
		border-radius: 6px;
		margin-bottom: 15px;
		font-size: 0.85rem;
		color: var(--text);
		display: flex;
		align-items: center;
		gap: 8px;
	}

	.promo-dates-icon {
		font-size: 1.1rem;
	}

	.promo-products {
		background: #f9f9f9;
		padding: 12px;
		border-radius: 6px;
		margin-bottom: 15px;
		border-left: 3px solid var(--primary);
	}

	.promo-products-title {
		font-size: 0.85rem;
		font-weight: 700;
		color: var(--dark);
		margin-bottom: 8px;
	}

	.promo-products-list {
		list-style: none;
		font-size: 0.85rem;
		color: var(--text);
	}

	.promo-products-list li {
		margin-bottom: 4px;
		padding-left: 16px;
		position: relative;
	}

	.promo-products-list li::before {
		content: '‚úì';
		position: absolute;
		left: 0;
		color: var(--success);
		font-weight: 700;
	}

	.promo-cta {
		text-align: center;
		margin-top: auto;
	}

	.promo-cta .btn {
		width: 100%;
	}

	.empty-promos {
		text-align: center;
		padding: 80px 20px;
		background: white;
		border-radius: 12px;
	}

	.empty-promos-icon {
		font-size: 4rem;
		margin-bottom: 20px;
	}

	.empty-promos h2 {
		color: var(--dark);
		margin-bottom: 10px;
	}

	/* Responsive */
	@media (max-width: 768px) {
		.promos-header h1 {
			font-size: 1.8rem;
		}

		.promos-grid {
			grid-template-columns: 1fr;
			gap: 20px;
		}

		.promo-image {
			height: 200px;
		}
	}
</style>

<div class="promos-header">
	<h1>üéâ Promociones Especiales</h1>
	<p>¬°Descuentos y ofertas exclusivas en nuestros deliciosos merengones!</p>
</div>

{% if promos %}
	<div class="promos-grid">
		{% for promo in promos %}
		<div class="promo-card">
			<div class="promo-image">
				{% if promo.imagen_url %}
					<img src="{{ promo.imagen_url }}" alt="{{ promo.titulo }}">
				{% else %}
					<span>üéÅ</span>
				{% endif %}
				
				{% if promo.tipo == 'descuento_porcentaje' %}
					<div class="promo-discount">-{{ promo.valor }}%</div>
				{% elif promo.tipo == 'descuento_monto' %}
					<div class="promo-discount" style="font-size: 1rem;">-${{ promo.valor|floatformat:0 }}</div>
				{% endif %}
			</div>

			<div class="promo-content">
				<h2 class="promo-title">{{ promo.titulo }}</h2>
				<p class="promo-description">{{ promo.descripcion }}</p>

				{% if promo.fecha_inicio or promo.fecha_fin %}
				<div class="promo-dates">
					<span class="promo-dates-icon">üïí</span>
					<span>
						{% if promo.fecha_fin %}
							V√°lido hasta {{ promo.fecha_fin|date:"d/m/Y" }}
						{% endif %}
					</span>
				</div>
				{% endif %}

				{% if promo.productos %}
				<div class="promo-products">
					<div class="promo-products-title">Productos Incluidos:</div>
					<ul class="promo-products-list">
						{% for prod in promo.productos|slice:":3" %}
							<li>{{ prod.nombre|truncatewords:2 }}</li>
						{% endfor %}
						{% if promo.productos|length > 3 %}
							<li><strong>+{{ promo.productos|length|add:"-3" }} productos m√°s</strong></li>
						{% endif %}
					</ul>
				</div>
				{% endif %}

				<div class="promo-cta">
					<a href="{% url 'productos' %}" class="btn btn-primary">Comprar Ahora</a>
				</div>
			</div>
		</div>
		{% endfor %}
	</div>

	<div style="background: linear-gradient(135deg, var(--accent) 0%, var(--primary-light) 100%); color: var(--primary); padding: 25px; border-radius: 12px; text-align: center; margin-top: 40px;">
		<strong style="font-size: 1.1rem;">‚≠ê ¬øTe perdiste de alguna promoci√≥n?</strong>
		<p style="margin: 10px 0 0 0; opacity: 0.9;">Suscr√≠bete a nuestras notificaciones para recibir ofertas exclusivas y descuentos especiales</p>
	</div>

{% else %}
	<div class="empty-promos">
		<div class="empty-promos-icon">üéÅ</div>
		<h2>No hay promociones activas en este momento</h2>
		<p>Revisa m√°s tarde para obtener ofertas especiales en nuestros merengones</p>
		<a href="{% url 'productos' %}" class="btn btn-primary" style="display: inline-block; margin-top: 20px;">Ver Todos los Productos</a>
	</div>
{% endif %}

{% endblock content %}
